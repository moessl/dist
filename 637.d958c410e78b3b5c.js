"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[637],{27637:function(pe,M,l){l.r(M),l.d(M,{TaxVoucherModule:function(){return de}});var b=l(28551),x=l(56213),$=l(98866),D=l(4521),Z=l(54004),t=l(59731),k=l(57957),S=l(49727),f=l(75617),z=l(69808),I=l(99590),C=l(29953),T=l(76042),E=l(92643),A=l(82683);function j(e,r){1&e&&t._UZ(0,"nz-spin",4)}function G(e,r){if(1&e){var n=t.EpF();t.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),t.NdJ("click",function(){return t.CHM(n),t.oxw().close()}),t._uU(4,"\u5173\u95ed"),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);var a=t.MAs(1);return t.oxw().save(a.value)}),t._uU(6,"\u4fdd\u5b58"),t.qZA()()()}if(2&e){var i=t.MAs(1),u=t.oxw();t.Q6J("schema",u.schema)("ui",u.ui)("formData",u.i),t.xp6(5),t.Q6J("disabled",!i.valid)("nzLoading",u.http.loading)}}var L=function(){var e=function(){function r(n,i,u){(0,x.Z)(this,r),this.modal=n,this.msgSrv=i,this.http=u,this.record={},this.schema={properties:{id:{type:"string",title:"\u7f16\u53f7",ui:{widget:"text",grid:{span:24}}},name:{type:"string",title:"\u6536\u4ef6\u4eba",maxLength:30},phone:{type:"string",title:"\u624b\u673a\u53f7",format:"mobile"},address:{type:"string",title:"\u5730\u5740",maxLength:200,ui:{widget:"textarea",grid:{span:24},autosize:{minRows:2,maxRows:6},placeholder:"\u52a1\u5fc5\u8bf7\u6ce8\u660e \u7701-\u5e02-\u533a(\u53bf)"}}},required:["owner","callNo","href","description"]},this.ui={"*":{spanLabelFixed:100,grid:{span:12}}}}return(0,b.Z)(r,[{key:"ngOnInit",value:function(){var u,o,a,i=this;((null===(u=this.record)||void 0===u?void 0:u.id)>0||(null===(o=this.i)||void 0===o?void 0:o.id)>0)&&this.http.get("/tax-voucher-express/".concat((null===(a=this.record)||void 0===a?void 0:a.id)>0?this.record.id:this.i.id)).subscribe(function(s){i.i=s.data,i.record=s.data})}},{key:"save",value:function(i){var u=this;i.id||delete i.id,this.http[this.record.id?"put":"post"]("/tax-voucher-express/".concat(this.record.id?this.record.id:""),i).subscribe(function(o){u.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),u.modal.close(o.data)})}},{key:"close",value:function(){this.modal.destroy()}}]),r}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(k.Lf),t.Y36(S.dD),t.Y36(f.lP))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tax-voucher-express-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,j,1,0,"nz-spin",2),t.YNc(4,G,7,5,"sf",3)),2&n&&(t.xp6(2),t.hij("\u7f16\u8f91 ",i.record.id," \u4fe1\u606f"),t.xp6(1),t.Q6J("ngIf",!i.i),t.xp6(1),t.Q6J("ngIf",i.i))},directives:[z.O5,I.W,C.kJ,T.ix,E.dQ,A.w],encapsulation:2}),e}(),X=["sf"];function K(e,r){1&e&&t._UZ(0,"nz-spin",4)}function W(e,r){if(1&e){var n=t.EpF();t.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),t.NdJ("click",function(){return t.CHM(n),t.oxw().close()}),t._uU(4,"\u5173\u95ed"),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);var a=t.MAs(1);return t.oxw().save(a.value)}),t._uU(6,"\u4fdd\u5b58"),t.qZA()()()}if(2&e){var i=t.MAs(1),u=t.oxw();t.Q6J("schema",u.schema)("ui",u.ui)("formData",u.i),t.xp6(5),t.Q6J("disabled",!i.valid)("nzLoading",u.http.loading)}}var w=function(){var e=function(){function r(n,i,u){var o=this;(0,x.Z)(this,r),this.modal=n,this.msgSrv=i,this.http=u,this.record={},this.schema={type:"object",properties:{id:{type:"string",title:"\u7f16\u53f7",ui:{widget:"text",grid:{span:24},visibleIf:{name:function(){return!0}}}},voucher_type:{type:"string",title:"\u62ac\u5934\u7c7b\u578b",enum:[{label:"\u589e\u503c\u7a0e\u666e\u901a\u53d1\u7968",value:"normal"},{label:"\u589e\u503c\u7a0e\u4e13\u7528\u53d1\u7968",value:"special"}],default:"normal",ui:{widget:"select",visibleIf:{id:function(){return!0}}}},name:{type:"string",title:"\u62ac\u5934",ui:{widget:"select",serverSearch:!0,searchDebounceTime:300,notFoundContent:"\u6ca1\u6709\u627e\u5230\u62ac\u5934\uff0c\u8bf7\u70b9\u51fb\u201c\u62ac\u5934\u7ba1\u7406\u201d\u53bb\u521b\u5efa",searchLoadingText:"\u641c\u7d22\u4e2d...",onSearch:function(s){var c;return s||(s=null===(c=o.sf.getProperty("/name"))||void 0===c?void 0:c.value),(null==s?void 0:s.trim().length)?o.http.get("/institution/search",{keyword:s}).pipe((0,Z.U)(function(p){return p.data.list.map(function(d){return{label:d.resultStr,value:d}})})).toPromise():[]},change:function(s){o.http.get("/institution/search-detail",{pid:s.pid,noPostalCode:1}).subscribe(function(d){var _,m,v,h,g,y,N,U;null===(m=null===(_=o.sf.getProperty("/name"))||void 0===_?void 0:_.widget)||void 0===m||m.setValue(s.resultStr),null===(h=null===(v=o.sf.getProperty("/phone"))||void 0===v?void 0:v.widget)||void 0===h||h.setValue(d.data.data.telephone),null===(y=null===(g=o.sf.getProperty("/serial"))||void 0===g?void 0:g.widget)||void 0===y||y.setValue(d.data.data.dataInfo.basic.taxNo),null===(U=null===(N=o.sf.getProperty("/address"))||void 0===N?void 0:N.widget)||void 0===U||U.setValue(d.data.data.dataInfo.basic.regAddr)})}}},serial:{type:"string",title:"\u7a0e\u53f7"},phone:{type:"string",title:"\u7535\u8bdd",ui:{widget:"string",grid:{span:12},visibleIf:{voucher_type:["special"]}}},address:{type:"string",title:"\u5730\u5740",maxLength:200,ui:{widget:"textarea",grid:{span:24},autosize:{minRows:2,maxRows:6},visibleIf:{voucher_type:["special"]}}},bank_name:{type:"string",title:"\u5f00\u6237\u884c",ui:{widget:"string",grid:{span:12},visibleIf:{voucher_type:["special"]}}},bank_account:{type:"string",title:"\u94f6\u884c\u8d26\u53f7",ui:{widget:"string",grid:{span:12},visibleIf:{voucher_type:["special"]}}}},required:["voucher_type","name","serial"]},this.ui={"*":{spanLabelFixed:100,grid:{span:12},visibleIf:{voucher_type:["$ANY$"]}}}}return(0,b.Z)(r,[{key:"ngOnInit",value:function(){var u,o,a,i=this;((null===(u=this.record)||void 0===u?void 0:u.id)>0||(null===(o=this.i)||void 0===o?void 0:o.id)>0)&&this.http.get("/tax-voucher-subscriber/".concat((null===(a=this.record)||void 0===a?void 0:a.id)>0?this.record.id:this.i.id)).subscribe(function(s){i.i=s.data,i.record=s.data,setTimeout(function(){var c,p;if(null===(c=i.sf.getProperty("/name"))||void 0===c?void 0:c.value){var d=null===(p=i.sf.getProperty("/name"))||void 0===p?void 0:p.value;i.http.get("/institution/search",{keyword:d}).subscribe(function(_){return _.data.list.filter(function(m){var v,h;m.resultStr==(null===(v=i.sf.getProperty("/name"))||void 0===v?void 0:v.value)&&(null===(h=i.sf.getProperty("/name"))||void 0===h?void 0:h.widget).change(m)})})}},500)})}},{key:"save",value:function(i){var u=this;i.id||delete i.id,this.http[this.record.id?"put":"post"]("/tax-voucher-subscriber/".concat(this.record.id?this.record.id:""),i).subscribe(function(o){u.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),u.modal.close(o.data)})}},{key:"close",value:function(){this.modal.destroy()}}]),r}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(k.Lf),t.Y36(S.dD),t.Y36(f.lP))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tax-voucher-subscriber-edit"]],viewQuery:function(n,i){var u;1&n&&t.Gf(X,5),2&n&&t.iGM(u=t.CRH())&&(i.sf=u.first)},decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,K,1,0,"nz-spin",2),t.YNc(4,W,7,5,"sf",3)),2&n&&(t.xp6(2),t.hij("\u7f16\u8f91 ",i.record.id," \u4fe1\u606f"),t.xp6(1),t.Q6J("ngIf",!i.i),t.xp6(1),t.Q6J("ngIf",i.i))},directives:[z.O5,I.W,C.kJ,T.ix,E.dQ,A.w],encapsulation:2}),e}(),tt=["sf"];function et(e,r){if(1&e&&(t.TgZ(0,"div",4),t._uU(1),t.qZA()),2&e){var n=t.oxw();t.xp6(1),t.hij("\u7f16\u8f91 ",n.record.id," \u53d1\u7968")}}function nt(e,r){1&e&&(t.TgZ(0,"div",4),t._uU(1,"\u7533\u8bf7\u5f00\u7968"),t.qZA())}function it(e,r){1&e&&t._UZ(0,"nz-spin",5)}function rt(e,r){if(1&e){var n=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(u){return t.CHM(n),t.oxw(2).editSubscriber(u)}),t._uU(1,"\u7f16\u8f91\u62ac\u5934"),t.qZA()}}function ut(e,r){if(1&e){var n=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(u){return t.CHM(n),t.oxw(2).editExpress(u)}),t._uU(1,"\u7f16\u8f91\u6536\u4ef6\u4eba"),t.qZA()}}function ot(e,r){1&e&&(t.ynx(0),t._uU(1,"\u4fdd\u5b58"),t.BQk())}function at(e,r){1&e&&(t.ynx(0),t._uU(1,"\u7533\u8bf7"),t.BQk())}function st(e,r){if(1&e&&(t.TgZ(0,"button",14),t.YNc(1,ot,2,0,"ng-container",15),t.YNc(2,at,2,0,"ng-container",15),t.qZA()),2&e){t.oxw();var n=t.MAs(1),i=t.oxw();t.Q6J("disabled",!n.valid)("nzLoading",i.http.loading),t.xp6(1),t.Q6J("ngIf",i.record),t.xp6(1),t.Q6J("ngIf",!i.record)}}function ct(e,r){if(1&e){var n=t.EpF();t.TgZ(0,"sf",6,7),t.NdJ("formSubmit",function(o){return t.CHM(n),t.oxw().save(o)}),t.YNc(2,rt,2,0,"ng-template",8),t.YNc(3,ut,2,0,"ng-template",9),t.TgZ(4,"div",10)(5,"button",11),t.NdJ("click",function(){return t.CHM(n),t.oxw().close()}),t._uU(6,"\u5173\u95ed"),t.qZA(),t.YNc(7,st,3,4,"button",12),t.qZA()()}if(2&e){var i=t.oxw();t.Q6J("schema",i.schema)("ui",i.ui)("formData",i.i)("button","none"),t.xp6(7),t.Q6J("ngIf",i.record)}}var J=function(){var e=function(){function r(n,i,u,o,a){var c,p,d,_,s=this;(0,x.Z)(this,r),this.settingSrv=n,this.mr=i,this.modal=u,this.msgSrv=o,this.http=a,this.record={},this.schema={properties:{hash_id:{type:"string",title:"\u7f16\u53f7",ui:{widget:"text",grid:{span:24}}},voucher_type:{type:"string",title:"\u53d1\u7968\u7c7b\u578b",enum:[{label:"\u589e\u503c\u7a0e\u666e\u901a\u53d1\u7968",value:"normal"},{label:"\u589e\u503c\u7a0e\u4e13\u7528\u53d1\u7968",value:"special"}],ui:{grid:{span:10},widget:"select",disabled:!!(null===(c=this.record)||void 0===c?void 0:c.hash_id)}},amount:{type:"number",title:"\u5f00\u7968\u91d1\u989d",ui:{grid:{span:12},widget:"number",disabled:!!(null===(p=this.record)||void 0===p?void 0:p.hash_id),class:"width-100",unit:"\u5143"}},tax_voucher_subscriber_id:{type:"string",title:"\u62ac\u5934",ui:{widget:"select",serverSearch:!0,searchDebounceTime:300,notFoundContent:"\u6ca1\u6709\u627e\u5230\u62ac\u5934\uff0c\u8bf7\u70b9\u51fb\u201c\u62ac\u5934\u7ba1\u7406\u201d\u53bb\u521b\u5efa",searchLoadingText:"\u641c\u7d22\u4e2d...",onSearch:function(v){return s.http.get("/tax-voucher-subscriber",{keyword:v}).pipe((0,Z.U)(function(h){return h.data.data.map(function(g){return{label:"("+("special"===g.voucher_type?"\u4e13":"\u666e")+")"+g.name,value:g.id}})})).toPromise()}}},subscriber_edit:{type:"string",title:"",ui:{grid:{span:8},spanLabelFixed:10,widget:"custom",spanLabel:0}},tax_voucher_express_id:{type:"string",title:"\u90ae\u5bc4\u4fe1\u606f",ui:{widget:"select",disabled:!!(null===(d=this.record)||void 0===d?void 0:d.hash_id),serverSearch:!0,searchDebounceTime:300,notFoundContent:"\u6ca1\u6709\u627e\u5230\u4fe1\u606f\uff0c\u521b\u5efa\u8bf7\u70b9\u201c\u90ae\u5bc4\u4fe1\u606f\u7ba1\u7406\u201d",searchLoadingText:"\u641c\u7d22\u4e2d...",onSearch:function(v){return s.http.get("/tax-voucher-express",{keyword:v}).pipe((0,Z.U)(function(h){return h.data.data.map(function(g){return{label:[g.name,g.phone,g.address].filter(function(y){return null==y?void 0:y.trim()}).join(" - "),value:g.id}})})).toPromise()}}},express_edit:{type:"string",title:"",ui:{grid:{span:8},spanLabelFixed:10,widget:"custom",spanLabel:0}},description:{type:"string",title:"\u63cf\u8ff0",maxLength:140,ui:{widget:"textarea",disabled:!!(null===(_=this.record)||void 0===_?void 0:_.hash_id),grid:{span:22},autosize:{minRows:3,maxRows:6}}}},required:["voucher_type","tax_voucher_subscriber_id","tax_voucher_express_id","amount"]},this.ui={"*":{spanLabelFixed:100,grid:{span:16}}}}return(0,b.Z)(r,[{key:"ngOnInit",value:function(){var i=this,u=function(){i.sf.formValueChange.subscribe(function(d){var _=d.path,m=i.sf.getProperty(_);m&&m.widget&&(m.setParentAndPlatErrors([],_),m.widget.showError=!1,m.widget.error="")});var a=i.sf.getProperty("/tax_voucher_subscriber_id"),s=i.sf.getProperty("/tax_voucher_express_id"),p=s.widget;a.value&&a.widget.onSearch(" "),s.value&&p.onSearch(" ")};this.record.hash_id?this.http.get("/tax-voucher/".concat(this.record.hash_id)).subscribe(function(o){i.i=o.data,setTimeout(u,500)}):setTimeout(u,500)}},{key:"save",value:function(i){var u=this;i&&!(null==i?void 0:i.id)&&delete i.id,this.http[this.record.hash_id?"put":"post"]("/tax-voucher/".concat(this.record.hash_id?this.record.hash_id:""),i).subscribe(function(o){u.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),u.mr.close(o.data),u.http.get("/user").subscribe(function(a){a.data.avatar="/assets/tmp/img/default_avatar.svg",u.settingSrv.setUser(a.data)})},function(o){var a;for(var s in o.error.errors){var c=u.sf.getProperty("/"+s);c&&c.widget&&(c.setParentAndPlatErrors(null===(a=o.error.errors[s])||void 0===a?void 0:a.map(function(p){return{keyword:p,message:p}}),"/"+s),c.widget.showError=!0,c.widget.formProperty.updateValueAndValidity({emitValueEvent:!1}))}console.log(o.error.errors)})}},{key:"close",value:function(){this.mr.destroy()}},{key:"editSubscriber",value:function(i){var u=this.sf.getProperty("/tax_voucher_subscriber_id");this.modal.createStatic(w,{i:u.value?{id:u.value}:{id:0}}).subscribe(function(o){u.setValue(o.hash_id,!0)}),i.preventDefault(),i.stopPropagation()}},{key:"editExpress",value:function(i){var u=this.sf.getProperty("/tax_voucher_express_id");this.modal.createStatic(L,{i:u.value?{id:u.value}:{id:0}}).subscribe(function(o){u.setValue(o.hash_id,!0)}),i.preventDefault(),i.stopPropagation()}}]),r}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.gb),t.Y36(k.Lf),t.Y36(f.Te),t.Y36(S.dD),t.Y36(f.lP))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tax-voucher-edit"]],viewQuery:function(n,i){var u;1&n&&t.Gf(tt,5),2&n&&t.iGM(u=t.CRH())&&(i.sf=u.first)},decls:5,vars:4,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["class","modal-spin",4,"ngIf"],["mode","edit",3,"schema","ui","formData","button","formSubmit",4,"ngIf"],[1,"modal-title"],[1,"modal-spin"],["mode","edit",3,"schema","ui","formData","button","formSubmit"],["sf",""],["sf-template","subscriber_edit"],["sf-template","express_edit"],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading",4,"ngIf"],["nz-button","",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading"],[4,"ngIf"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.YNc(1,et,2,1,"div",1),t.YNc(2,nt,2,0,"div",1),t.qZA(),t.YNc(3,it,1,0,"nz-spin",2),t.YNc(4,ct,8,5,"sf",3)),2&n&&(t.xp6(1),t.Q6J("ngIf",null==i.record?null:i.record.id),t.xp6(1),t.Q6J("ngIf",!(null!=i.record&&i.record.id)),t.xp6(1),t.Q6J("ngIf",!i.i),t.xp6(1),t.Q6J("ngIf",i.i))},directives:[z.O5,I.W,C.kJ,C.gv,T.ix,E.dQ,A.w],encapsulation:2}),e}(),F=l(54350),lt=["st"],dt=function(){return{pi:"page",ps:"page_size",skip:"skip",limit:"limit",keyword:"keyword"}},Y=function(r){return{reName:r}},pt=function(){return{total:"data.total",list:"data.data"}},Q=function(){var e=function(){function r(n,i){(0,x.Z)(this,r),this.http=n,this.modal=i,this.url="/tax-voucher-express",this.searchSchema={properties:{id:{type:"string",title:"\u7f16\u53f7"}}},this.columns=[{title:"\u7f16\u53f7",index:"id"},{title:"\u6536\u4ef6\u4eba",index:"name"},{title:"\u7535\u8bdd",index:"phone"},{title:"\u5730\u5740",index:"address"},{title:"",buttons:[{text:"\u7f16\u8f91",type:"modal",modal:{component:L,paramsName:"record"},click:"reload"}]}]}return(0,b.Z)(r,[{key:"ngOnInit",value:function(){}},{key:"add",value:function(){var i=this;this.modal.createStatic(L,{i:{id:0}}).subscribe(function(){return i.st.reload()})}}]),r}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.lP),t.Y36(f.Te))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tax-voucher-express-list"]],viewQuery:function(n,i){var u;1&n&&t.Gf(lt,5),2&n&&t.iGM(u=t.CRH())&&(i.st=u.first)},decls:10,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],["mode","search",1,"d-inline-block","align-middle",3,"schema","formSubmit","formReset"],[1,"d-inline-block","align-middle","ml-sm"],["nz-button","","nzType","primary",3,"click"],[3,"data","columns","req","res"],["st",""]],template:function(n,i){if(1&n){var u=t.EpF();t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"\u90ae\u5bc4\u4fe1\u606f\u7ba1\u7406"),t.qZA()(),t.TgZ(3,"div",2)(4,"sf",3),t.NdJ("formSubmit",function(a){return t.CHM(u),t.MAs(9).reset(a)})("formReset",function(a){return t.CHM(u),t.MAs(9).reset(a)}),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return i.add()}),t._uU(7,"\u65b0\u589e\u90ae\u5bc4\u4fe1\u606f"),t.qZA()(),t._UZ(8,"st",6,7),t.qZA()}2&n&&(t.xp6(4),t.Q6J("schema",i.searchSchema),t.xp6(1),t.Udp("height","40px"),t.xp6(3),t.Q6J("data",i.url)("columns",i.columns)("req",t.VKq(8,Y,t.DdM(7,dt)))("res",t.VKq(11,Y,t.DdM(10,pt))))},directives:[C.kJ,T.ix,E.dQ,A.w,F.A5],encapsulation:2}),e}(),q=l(28481),_t=["st"];function mt(e,r){1&e&&(t.TgZ(0,"nz-tag",11),t._uU(1,"\u589e\u503c\u7a0e\u666e\u901a\u53d1\u7968"),t.qZA())}function ft(e,r){1&e&&(t.TgZ(0,"nz-tag",12),t._uU(1,"\u589e\u503c\u7a0e\u4e13\u7528\u53d1\u7968"),t.qZA())}var gt=function(){return["normal"]},vt=function(){return["special"]};function ht(e,r){if(1&e&&(t.YNc(0,mt,2,0,"nz-tag",9),t.YNc(1,ft,2,0,"nz-tag",10)),2&e){var n=r.$implicit;t.Q6J("ngIf",t.DdM(2,gt).includes(n.voucher_type)),t.xp6(1),t.Q6J("ngIf",t.DdM(3,vt).includes(n.voucher_type))}}var bt=function(){return{pi:"page",ps:"page_size",skip:"skip",limit:"limit",keyword:"keyword"}},P=function(r){return{reName:r}},xt=function(){return{total:"data.total",list:"data.data"}},B=function(){var e=function(){function r(n,i){(0,x.Z)(this,r),this.http=n,this.modal=i,this.url="/tax-voucher-subscriber",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.columns=[{title:"\u7f16\u53f7",index:"id"},{title:"\u62ac\u5934\u7c7b\u578b",index:"voucher_type",render:"voucherTypeTpl"},{title:"\u62ac\u5934",index:"name"},{title:"\u7a0e\u53f7",index:"serial"},{title:"\u7535\u8bdd",index:"phone"},{title:"\u5730\u5740",index:"address"},{title:"\u5f00\u6237\u884c",index:"bank_name"},{title:"\u94f6\u884c\u8d26\u53f7",index:"bank_account"},{title:"\u65f6\u95f4",type:"date",index:"created_at"},{title:"",buttons:[{text:"\u7f16\u8f91",type:"modal",modal:{component:w,paramsName:"record"},click:"reload"}]}]}return(0,b.Z)(r,[{key:"ngOnInit",value:function(){}},{key:"add",value:function(){var i=this;this.modal.createStatic(w,{i:{id:0}}).subscribe(function(){return i.st.reload()})}}]),r}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.lP),t.Y36(f.Te))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tax-voucher-subscriber-list"]],viewQuery:function(n,i){var u;1&n&&t.Gf(_t,5),2&n&&t.iGM(u=t.CRH())&&(i.st=u.first)},decls:11,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],["mode","search",1,"d-inline-block","align-middle",3,"schema","formSubmit","formReset"],[1,"d-inline-block","align-middle","ml-sm"],["nz-button","","nzType","primary",3,"click"],[3,"data","columns","req","res"],["st",""],["st-row","voucherTypeTpl"],["nzColor","default",4,"ngIf"],["nzColor","warning",4,"ngIf"],["nzColor","default"],["nzColor","warning"]],template:function(n,i){if(1&n){var u=t.EpF();t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"\u62ac\u5934\u7ba1\u7406"),t.qZA()(),t.TgZ(3,"div",2)(4,"sf",3),t.NdJ("formSubmit",function(a){return t.CHM(u),t.MAs(9).reset(a)})("formReset",function(a){return t.CHM(u),t.MAs(9).reset(a)}),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return i.add()}),t._uU(7,"\u65b0\u589e\u62ac\u5934"),t.qZA()(),t.TgZ(8,"st",6,7),t.YNc(10,ht,2,4,"ng-template",8),t.qZA()()}2&n&&(t.xp6(4),t.Q6J("schema",i.searchSchema),t.xp6(1),t.Udp("height","40px"),t.xp6(3),t.Q6J("data",i.url)("columns",i.columns)("req",t.VKq(8,P,t.DdM(7,bt)))("res",t.VKq(11,P,t.DdM(10,xt))))},directives:[C.kJ,T.ix,E.dQ,A.w,F.A5,F.wZ,z.O5,q.j],encapsulation:2}),e}(),Ct=l(25503),yt=l(38169),O=l(71758),Tt=l(42466),Et=l(98569),At=["st"],Zt=function(){return["/"]};function zt(e,r){1&e&&(t.TgZ(0,"nz-breadcrumb")(1,"nz-breadcrumb-item")(2,"a",16),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"nz-breadcrumb-item"),t._uU(6),t.ALo(7,"translate"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("routerLink",t.DdM(7,Zt)),t.xp6(1),t.Oqu(t.lcZ(4,3,"home")),t.xp6(3),t.Oqu(t.lcZ(7,5,"menu.account.tax-voucher")))}function Ft(e,r){1&e&&(t.ynx(0),t._uU(1,"\uffe5"),t.BQk())}function Lt(e,r){1&e&&(t.ynx(0),t._uU(1,"$"),t.BQk())}function wt(e,r){1&e&&(t.ynx(0),t._uU(1,"\uffe5"),t.BQk())}function Dt(e,r){1&e&&(t.ynx(0),t._uU(1,"$"),t.BQk())}function kt(e,r){if(1&e&&(t.TgZ(0,"span",17),t._uU(1," ("),t.TgZ(2,"span",3),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"span"),t.YNc(6,wt,2,0,"ng-container",4),t.YNc(7,Dt,2,0,"ng-container",4),t._uU(8),t.qZA(),t._uU(9," ) "),t.qZA()),2&e){var n=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,6,"\u5df2\u5f00\u7968"),": "),t.xp6(2),t.Udp("text-decoration","underline"),t.xp6(1),t.Q6J("ngIf","cny"==n.user.currency),t.xp6(1),t.Q6J("ngIf","usd"==n.user.currency),t.xp6(1),t.hij("",n.user.tax_total," ")}}function St(e,r){1&e&&(t.TgZ(0,"nz-tag",20),t._uU(1,"\u589e\u503c\u7a0e\u666e\u901a\u53d1\u7968"),t.qZA())}function It(e,r){1&e&&(t.TgZ(0,"nz-tag",21),t._uU(1,"\u589e\u503c\u7a0e\u4e13\u7528\u53d1\u7968"),t.qZA())}var Jt=function(){return["normal"]},Qt=function(){return["special"]};function Bt(e,r){if(1&e&&(t.YNc(0,St,2,0,"nz-tag",18),t.YNc(1,It,2,0,"nz-tag",19)),2&e){var n=r.$implicit;t.Q6J("ngIf",t.DdM(2,Jt).includes(n.voucher_type)),t.xp6(1),t.Q6J("ngIf",t.DdM(3,Qt).includes(n.voucher_type))}}function Nt(e,r){if(1&e&&(t.TgZ(0,"nz-tag"),t._uU(1),t.qZA()),2&e){var n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.express.name)}}function Ut(e,r){if(1&e&&(t.TgZ(0,"nz-tag"),t._uU(1),t.qZA()),2&e){var n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.express.phone)}}function Mt(e,r){if(1&e&&(t.TgZ(0,"nz-tag"),t._uU(1),t.qZA()),2&e){var n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.express.address)}}function Yt(e,r){1&e&&(t.TgZ(0,"nz-tag",23),t._uU(1,"\u9000\u7968(\u7ea2\u51b2)"),t.qZA())}var R=function(){return["revoke"]};function qt(e,r){if(1&e&&(t.YNc(0,Nt,2,1,"nz-tag",4),t.YNc(1,Ut,2,1,"nz-tag",4),t.YNc(2,Mt,2,1,"nz-tag",4),t.YNc(3,Yt,2,0,"nz-tag",22)),2&e){var i,u,o,n=r.$implicit;t.Q6J("ngIf",null==n.express.name||null==(i=n.express.name.trim())?null:i.length),t.xp6(1),t.Q6J("ngIf",null==n.express.phone||null==(u=n.express.phone.trim())?null:u.length),t.xp6(1),t.Q6J("ngIf",null==n.express.address||null==(o=n.express.address.trim())?null:o.length),t.xp6(1),t.Q6J("ngIf",t.DdM(4,R).includes(n.operation))}}function Pt(e,r){1&e&&(t.TgZ(0,"nz-tag",25),t._uU(1,"\u65b0\u5f00"),t.qZA())}function Ot(e,r){1&e&&(t.TgZ(0,"nz-tag",23),t._uU(1,"\u9000\u7968(\u7ea2\u51b2)"),t.qZA())}var Rt=function(){return["new"]};function Vt(e,r){if(1&e&&(t.YNc(0,Pt,2,0,"nz-tag",24),t.YNc(1,Ot,2,0,"nz-tag",22)),2&e){var n=r.$implicit;t.Q6J("ngIf",t.DdM(2,Rt).includes(n.operation)),t.xp6(1),t.Q6J("ngIf",t.DdM(3,R).includes(n.operation))}}function Ht(e,r){1&e&&(t.TgZ(0,"nz-tag",21),t._uU(1,"\u7b49\u5f85\u5f00\u7968"),t.qZA())}function $t(e,r){1&e&&(t.TgZ(0,"nz-tag",20),t._uU(1,"\u5df2\u53d6\u6d88"),t.qZA())}function jt(e,r){1&e&&(t.TgZ(0,"nz-tag",25),t._uU(1,"\u5df2\u5f00\u5177"),t.qZA())}function Gt(e,r){1&e&&(t.TgZ(0,"nz-tag",27),t._uU(1,"\u5df2\u9000\u7968"),t.qZA())}function Xt(e,r){if(1&e){var n=t.EpF();t.TgZ(0,"nz-tag",29),t.NdJ("click",function(){t.CHM(n);var u=t.oxw(2).$implicit;return t.oxw().window.open(u.delivery_link)}),t._uU(1,"\u4e0b\u8f7d"),t.qZA()}}function Kt(e,r){if(1&e&&(t.TgZ(0,"nz-tag"),t._uU(1),t.qZA()),2&e){var n=t.oxw(2).$implicit;t.xp6(1),t.AsE(" ",n.delivery_express_vendor," # ",n.delivery_express_no," ")}}function Wt(e,r){if(1&e&&(t.ynx(0),t.YNc(1,Xt,2,0,"nz-tag",28),t.YNc(2,Kt,2,2,"nz-tag",4),t.BQk()),2&e){var n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.delivery_link),t.xp6(1),t.Q6J("ngIf",!n.delivery_link)}}var te=function(){return["pending"]},ee=function(){return["cancelled"]},ne=function(){return["active"]},ie=function(){return["revoked"]},re=function(){return["active","revoked"]};function ue(e,r){if(1&e&&(t.YNc(0,Ht,2,0,"nz-tag",19),t.YNc(1,$t,2,0,"nz-tag",18),t.YNc(2,jt,2,0,"nz-tag",24),t.YNc(3,Gt,2,0,"nz-tag",26),t.YNc(4,Wt,3,2,"ng-container",4)),2&e){var n=r.$implicit;t.Q6J("ngIf",t.DdM(5,te).includes(n.status)),t.xp6(1),t.Q6J("ngIf",t.DdM(6,ee).includes(n.status)),t.xp6(1),t.Q6J("ngIf",t.DdM(7,ne).includes(n.status)),t.xp6(1),t.Q6J("ngIf",t.DdM(8,ie).includes(n.status)),t.xp6(1),t.Q6J("ngIf",t.DdM(9,re).includes(n.status))}}var oe=function(){return{precision:2,ingoreZeroPrecision:!1}},ae=function(){return{pi:"page",ps:"page_size",skip:"skip",limit:"limit",keyword:"keyword"}},V=function(r){return{reName:r}},se=function(){return{total:"data.total",list:"data.data"}},ce=[{path:"",component:function(){var e=function(){function r(n,i,u,o){var a=this;(0,x.Z)(this,r),this.settings=n,this.http=i,this.modal=u,this.i18n=o,this.url="/tax-voucher",this.searchSchema={properties:{hash_id:{type:"string",title:"",ui:{placeholder:this.i18n.fanyi("ID"),grid:{xs:{span:24},sm:{span:24},md:{span:4},lg:{span:3}},class:["width-100-xs","width-90px-md"]}},voucher_type:{type:"string",title:"",enum:[{label:"\u589e\u503c\u7a0e\u666e\u901a\u53d1\u7968",value:"normal"},{label:"\u589e\u503c\u7a0e\u4e13\u7528\u53d1\u7968",value:"special"}],ui:{placeholder:this.i18n.fanyi("\u53d1\u7968\u7c7b\u578b"),grid:{xs:{span:24},sm:{span:24},md:{span:4},lg:{span:3}},widget:"select",allowClear:!0}},tax_voucher_subscriber_id:{type:"string",title:"",ui:{placeholder:this.i18n.fanyi("\u62ac\u5934"),grid:{xs:{span:24},sm:{span:24},md:{span:4},lg:{span:3}},widget:"select",serverSearch:!0,allowClear:!0,searchDebounceTime:300,notFoundContent:"\u6ca1\u6709\u627e\u5230\u62ac\u5934",searchLoadingText:"\u641c\u7d22\u4e2d...",onSearch:function(c){return a.http.get("/tax-voucher-subscriber",{keyword:c}).pipe((0,Z.U)(function(p){return p.data.data.map(function(d){return{label:"("+("special"===d.voucher_type?"\u4e13":"\u666e")+")"+d.name,value:d.id}})})).toPromise()}}},tax_voucher_express_id:{type:"string",title:"",ui:{placeholder:this.i18n.fanyi("\u6536\u4ef6\u4eba"),grid:{xs:{span:24},sm:{span:24},md:{span:4},lg:{span:3}},widget:"select",serverSearch:!0,allowClear:!0,searchDebounceTime:300,notFoundContent:"\u6ca1\u6709\u627e\u5230\u6536\u4ef6\u4eba",searchLoadingText:"\u641c\u7d22\u4e2d...",onSearch:function(c){return a.http.get("/tax-voucher-express",{keyword:c}).pipe((0,Z.U)(function(p){return p.data.data.map(function(d){return{label:[d.name,d.phone,d.address].filter(function(_){return null==_?void 0:_.trim()}).join(" - "),value:d.id}})})).toPromise()}}}}},this.columns=[{title:"ID",index:"hash_id"},{title:"\u62ac\u5934",index:"subscriber.name"},{title:"\u64cd\u4f5c",index:"operation",render:"operationTpl"},{title:"\u90ae\u5bc4\u4fe1\u606f",index:"express.name",render:"expressTpl"},{title:"\u5f00\u7968\u91d1\u989d",index:"amount",type:"currency",currency:{format:{precision:2,ingoreZeroPrecision:!1}}},{title:"\u7c7b\u578b",index:"voucher_type",render:"voucherTypeTpl"},{title:"\u72b6\u6001",index:"status",render:"statusTpl"},{title:"\u65f6\u95f4",type:"date",index:"created_at"},{title:"",buttons:[{text:"\u7f16\u8f91",type:"modal",modal:{component:J,paramsName:"record"},click:"reload"}]}]}return(0,b.Z)(r,[{key:"user",get:function(){return this.settings.user}},{key:"ngOnInit",value:function(){}},{key:"add",value:function(){var i=this;this.modal.createStatic(J,{i:{id:0}}).subscribe(function(){return i.st.reload()})}},{key:"manageSubscribers",value:function(){var i=this;this.modal.createStatic(B,{},{size:"xl"}).subscribe(function(){return i.st.reload()})}},{key:"manageExpresses",value:function(){var i=this;this.modal.createStatic(Q,{},{size:"xl"}).subscribe(function(){return i.st.reload()})}}]),r}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.gb),t.Y36(f.lP),t.Y36(f.Te),t.Y36(Ct.t$))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tax-voucher-list"]],viewQuery:function(n,i){var u;1&n&&t.Gf(At,5),2&n&&t.iGM(u=t.CRH())&&(i.st=u.first)},decls:35,vars:38,consts:[[3,"breadcrumb","title","homeI18n"],["breadcrumbTpl",""],[1,"mr-md"],[1,"font-weight-normal"],[4,"ngIf"],["class","ml-sm",4,"ngIf"],["nz-button","",3,"nzType","click"],["nz-button","",3,"click"],["mode","search",1,"d-inline-block","align-middle",3,"schema","formSubmit","formReset"],[1,"d-none"],["bordered","",3,"data","columns","req","res"],["st",""],["st-row","voucherTypeTpl"],["st-row","expressTpl"],["st-row","operationTpl"],["st-row","statusTpl"],[3,"routerLink"],[1,"ml-sm"],["nzColor","default",4,"ngIf"],["nzColor","warning",4,"ngIf"],["nzColor","default"],["nzColor","warning"],["nzColor","danger",4,"ngIf"],["nzColor","danger"],["nzColor","success",4,"ngIf"],["nzColor","success"],["nzColor","error",4,"ngIf"],["nzColor","error"],[3,"click",4,"ngIf"],[3,"click"]],template:function(n,i){if(1&n){var u=t.EpF();t.TgZ(0,"page-header",0),t.ALo(1,"translate"),t.ALo(2,"translate"),t.YNc(3,zt,8,8,"ng-template",null,1,t.W1O),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"h1")(8,"span",2)(9,"span",3),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"span"),t.YNc(13,Ft,2,0,"ng-container",4),t.YNc(14,Lt,2,0,"ng-container",4),t.ynx(15),t.TgZ(16,"span"),t._uU(17),t.ALo(18,"price"),t.qZA(),t.BQk(),t.qZA(),t.YNc(19,kt,10,8,"span",5),t.qZA(),t.TgZ(20,"button",6),t.NdJ("click",function(){return i.add()}),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"button",7),t.NdJ("click",function(){return i.manageSubscribers()}),t._uU(24,"\u7ba1\u7406\u62ac\u5934"),t.qZA(),t.TgZ(25,"button",7),t.NdJ("click",function(){return i.manageExpresses()}),t._uU(26,"\u7ba1\u7406\u6536\u4ef6\u4eba"),t.qZA()(),t.TgZ(27,"sf",8),t.NdJ("formSubmit",function(s){return t.CHM(u),t.MAs(30).reset(s)})("formReset",function(s){return t.CHM(u),t.MAs(30).reset(s)}),t.qZA(),t._UZ(28,"div",9),t.TgZ(29,"st",10,11),t.YNc(31,Bt,2,4,"ng-template",12),t.YNc(32,qt,4,5,"ng-template",13),t.YNc(33,Vt,2,4,"ng-template",14),t.YNc(34,ue,5,10,"ng-template",15),t.qZA()}if(2&n){var o=t.MAs(4);t.Q6J("breadcrumb",o)("title",t.lcZ(1,18,"menu.account.tax-voucher"))("homeI18n",t.lcZ(2,20,"home")),t.xp6(5),t.hij(" ",t.lcZ(6,22,"menu.account.tax-voucher.description"),"\n"),t.xp6(5),t.hij(" ",t.lcZ(11,24,"\u5269\u4f59\u53ef\u5f00\u7968\u91d1\u989d"),": "),t.xp6(2),t.Udp("text-decoration","underline"),t.xp6(1),t.Q6J("ngIf","cny"==i.user.currency),t.xp6(1),t.Q6J("ngIf","usd"==i.user.currency),t.xp6(3),t.Oqu(t.xi3(18,26,i.user.spent_total-i.user.tax_total,t.DdM(31,oe))),t.xp6(2),t.Q6J("ngIf",i.user.tax_total>0),t.xp6(1),t.Q6J("nzType","primary"),t.xp6(1),t.Oqu(t.lcZ(22,29,"\u7533\u8bf7\u5f00\u7968")),t.xp6(6),t.Q6J("schema",i.searchSchema),t.xp6(2),t.Q6J("data",i.url)("columns",i.columns)("req",t.VKq(33,V,t.DdM(32,ae)))("res",t.VKq(36,V,t.DdM(35,se)))}},directives:[yt.q,O.Dg,O.MO,D.yS,z.O5,T.ix,E.dQ,A.w,C.kJ,F.A5,F.wZ,q.j],pipes:[Tt.X$,Et.RZ],encapsulation:2}),e}()},{path:"subscriberList",component:B},{path:"expressList",component:Q}],le=function(){var e=(0,b.Z)(function r(){(0,x.Z)(this,r)});return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[D.Bz.forChild(ce)],D.Bz]}),e}(),de=function(){var e=(0,b.Z)(function r(){(0,x.Z)(this,r)});return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[$.m8,le]]}),e}()}}]);